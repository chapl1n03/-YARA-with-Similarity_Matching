12: rule_1...rule_12: 12 strings: s1...sri, condition: at least n_si

Command: yara tar_file_1 rule_1

Normal Yara workflow:
parser:
	convert tar_file_1 into FSM using Aho Corasick algorithm
lexer: 
	n_strings = 12 # len([s1...s12])
	for each_string in [s1...s12] in rule_1:
		each_string converted to atoms a1...an
		for each_atom in a1...an:
			check if each_atom present within the FSM representation of tar_file_1
			if yes, atom_match_count += 1
		if atom_match_count == n, # all n atoms match, then string s1 has an exact match with tar_file_1
			exact_string_match_count += 1
	if exact_string_match_count >= condition: # more than condition no of strings exact matched 
		exact_matching_rule_decision = 1 # rule positive
	else:
		exact_matching_rule_decision = 0 # rule negative
	return exact_matching_rule_decision
		
--------------------------------------------------------------------------------
Command: yara tar_file_1 rule_1 -threshold 60

parser:
	convert tar_file_1 into FSM using Aho Corasick algorithm
lexer: 
	n_strings = 12 # len([s1...s12])
	for each_string in [s1...s12] in rule_1:
		each_string converted to atoms a1...an
		for each_atom in a1...an:
			check if each_atom present within the FSM representation of tar_file_1
			if yes, atom_match_count += 1
		if atom_match_count == n, # all n atoms match, then string s1 has an exact match with tar_file_1
			exact_string_match_count += 1
	if exact_string_match_count >= condition: # more than condition no of strings exact matched 
		exact_matching_rule_decision = 1 # rule positive
	else:
		exact_matching_rule_decision = 0 # rule negative

	for each_string in [s1...s12] in rule_1:
		each_string converted to atoms a1...an
		for each_atom in a1...an:
			check if each_atom present within the FSM representation of tar_file_1
			if yes, atom_match_count += 1
		partial_ratio = atom_match_count / n # percentage similarity
		if partial_ratio >= threshold:
			partial_string_match_count+ = 1
	if partial_string_match_count >= condition: # more than condition no of strings exact matched 
		partial_string_match_decision = 1 # rule positive
	else:
		partial_string_match_decision = 0 # rule negative

	return exact_matching_rule_decision, partial_string_match_decision
		
